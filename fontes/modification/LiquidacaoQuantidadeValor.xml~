<?xml version="1.0" encoding="ISO-8859-1"?>
<modification>
  <name>LiquidacaoQuantidadeValor</name>
  <id>LiquidacaoQuantidadeValor</id>
  <ecidade-version>2.3.39</ecidade-version>
  
  <file path='forms/db_frmliquidasemordem.php'>
    <operation>
      <search><![CDATA[/* Plugin [LiquidacaoQuantidadeValor] - Parte 1 */]]></search>
      <add position="after">
        <![CDATA[        var sServicoQuant = obj.data[i].servicoquantidade == "t" ? "true" : "false";
        var sServico      = obj.data[i].pc01_servico      == "t" ? "true" : "false";]]>
      </add>
    </operation>

    <operation>
      <search><![CDATA[saida += "    <input type='text' style='text-align:right' name='vlrtot"+obj.data[i].e62_sequen+"'";
        saida += "           id='vlrtot"+obj.data[i].e62_sequen+"'  value='"+obj.data[i].e62_vlrtot+"' "+sDesabilitaValor;
        saida += "           size='5' class='valores' onkeypress='return js_teclas(event)'";
        saida += "          onblur='js_calculaValor("+obj.data[i].e62_sequen+",2)' "+obj.data[i].libera+">"
        saida += "  </td>";]]></search>
      <add position="replace">
        <![CDATA[saida += "    <input type='text' style='text-align:right' name='vlrtot"+obj.data[i].e62_sequen+"'";
        saida += "           id='vlrtot"+obj.data[i].e62_sequen+"'  value='"+obj.data[i].e62_vlrtot+"' "+sDesabilitaValor;
        saida += "           size='5' class='valores' onkeypress='return js_teclas(event)'";
        saida += "          onblur='js_calculaValor("+obj.data[i].e62_sequen+",2); js_verificaQuantidade("+obj.data[i].e62_sequen+", "+sServicoQuant+", "+sServico+")' "+obj.data[i].libera+">"
        saida += "  </td>";]]>
      </add>
    </operation>

    <operation>
      <search><![CDATA[/* Plugin [LiquidacaoQuantidadeValor] - Parte 2 */]]></search>
      <add position="after">
        <![CDATA[  function js_verificaQuantidade(sequenItem, ServicoQuantidade, Servico){
    var saldo = document.getElementById('saldovlr'+sequenItem).innerHTML;
    var valor = document.getElementById('vlrtot'+sequenItem).value;
    if ((ServicoQuantidade == true || Servico == true) && (parseFloat(valor) != parseFloat(saldo))){
      alert("O item é controlado por quantidade, mas você alterou o valor. Verifique.");
    }
  }]]>
      </add>
    </operation>

  </file>

</modification>
